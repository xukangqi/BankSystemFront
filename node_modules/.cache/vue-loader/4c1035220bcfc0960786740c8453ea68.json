{"remainingRequest":"/Users/xyy/Desktop/前端开发/project/BankSystemFront-xkq/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xyy/Desktop/前端开发/project/BankSystemFront-xkq/src/views/admin/loan/loanManage.vue?vue&type=style&index=0&id=2b08e28a&scoped=true&lang=scss&","dependencies":[{"path":"/Users/xyy/Desktop/前端开发/project/BankSystemFront-xkq/src/views/admin/loan/loanManage.vue","mtime":1539942342000},{"path":"/Users/xyy/Desktop/前端开发/project/BankSystemFront-xkq/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/xyy/Desktop/前端开发/project/BankSystemFront-xkq/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/xyy/Desktop/前端开发/project/BankSystemFront-xkq/node_modules/postcss-loader/lib/index.js","mtime":499162500000},{"path":"/Users/xyy/Desktop/前端开发/project/BankSystemFront-xkq/node_modules/sass-loader/lib/loader.js","mtime":1533139052000},{"path":"/Users/xyy/Desktop/前端开发/project/BankSystemFront-xkq/node_modules/cache-loader/dist/cjs.js","mtime":1540002788970},{"path":"/Users/xyy/Desktop/前端开发/project/BankSystemFront-xkq/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.custom-filter-dropdown {\n    padding: 8px;\n    border-radius: 6px;\n    background: #fff;\n    box-shadow: 0 1px 6px rgba(0, 0, 0, 0.2);\n}\n\n.custom-filter-dropdown input {\n    width: 130px;\n    margin-right: 8px;\n}\n\n.custom-filter-dropdown button {\n    margin-right: 8px;\n}\n\n.highlight {\n    color: #f50;\n}\n",{"version":3,"sources":["loanManage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiTA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"loanManage.vue","sourceRoot":"src/views/admin/loan","sourcesContent":["<template>\n    <div>\n        <a-table :dataSource=\"data\" :columns=\"columns\" :scroll=\"{ x: 1500}\">\n            <div slot=\"filterDropdown\" slot-scope=\"{ setSelectedKeys, selectedKeys, confirm, clearFilters }\" class='custom-filter-dropdown'>\n                <a-input ref=\"searchInput\" placeholder='查找用户' :value=\"selectedKeys[0]\" @change=\"e => setSelectedKeys(e.target.value ? [e.target.value] : [])\"\n                    @pressEnter=\"() => handleSearch(selectedKeys, confirm)\" />\n                <a-button type='primary' @click=\"() => handleSearch(selectedKeys, confirm)\">Search</a-button>\n                <a-button @click=\"() => handleReset(clearFilters)\">Reset</a-button>\n            </div>\n\n            <a-icon slot=\"filterIcon\" slot-scope=\"filtered\" type='smile-o' :style=\"{ color: filtered ? '#108ee9' : '#aaa' }\" />\n            <template slot=\"customRender\" slot-scope=\"text\">\n                <span v-if=\"searchText\">\n                    <template v-for=\"(fragment, i) in text.split(new RegExp(`(?<=${searchText})|(?=${searchText})`, 'i'))\">\n                        <span v-if=\"fragment.toLowerCase() === searchText.toLowerCase()\" :key=\"i\" class=\"highlight\">{{fragment}}</span>\n                        <template v-else>{{fragment}}</template>\n                    </template>\n                </span>\n                <template v-else>{{text}}</template>\n            </template>\n            <template slot=\"operation\" slot-scope=\"text, record\">\n                <a-button type='primary' @click=\"() => showDrawer(record.transId)\">显示详情</a-button>\n            </template>\n        </a-table>\n        <a-drawer title=\"Create\" width=720 placement=\"right\" :closable=\"false\" @close=\"onClose\" :visible=\"visible\"\n            style=\"height: calc(100% - 55px);overflow: 'auto';paddingBottom: 53px\">\n            <div>\n                <a-collapse accordion>\n                    <a-collapse-panel header=\"贷款详细信息\" key=\"1\">\n                        <p>贷款交易流水号:{{this.detailValue.transId}}</p>\n                        <p>贷款账户:{{this.detailValue.account}}</p>\n                        <p>贷款日期:{{formatDate(this.detailValue.transDate)}}</p>\n                        <p>贷款金额:{{this.detailValue.loanAmount}}</p>\n                        <p>分期数目:{{this.detailValue.insCount}}</p>\n                        <p>贷款利率:{{this.detailValue.loanInterest}}}</p>\n                        <p>贷款总金额:{{this.detailValue.loanAmountSum}}</p>\n                        <p>到期时间:{{formatDate(this.detailValue.expirationDate)}}</p>\n                        <p>已收到还款:{{this.detailValue.recoveredAmount}}</p>\n                        <p>贷款状态:{{formatLoanStatus(this.detailValue.loanStatus)}}</p>\n                        <p>贷款类型:{{this.detailValue.loadTypeName}}</p>\n                        <p>审核人信息:{{this.detailValue.reviewId}}</p>\n                    </a-collapse-panel>\n                    <a-collapse-panel header=\"还款记录\" key=\"2\" :disabled='false'>\n                        <a-table :columns=\"paymentColumns\" :dataSource=\"loanPayment\">\n                            <!-- <a slot=\"action\" slot-scope=\"text\" href=\"javascript:;\">action</a> -->\n                        </a-table>\n                    </a-collapse-panel>\n                </a-collapse>\n            </div>\n            <div :style=\"{\n          position: 'absolute',\n          bottom: 0,\n          width: '100%',\n          borderTop: '1px solid #e8e8e8',\n          padding: '10px 16px',\n          textAlign: 'right',\n          left: 0,\n          background: '#fff',\n          borderRadius: '0 0 4px 4px',\n        }\">\n                <a-button :style=\"{\n            marginRight: 8,\n          }\" @click=\"onClose\">\n                    关闭\n                </a-button>\n                <!-- <a-button @click=\"onClose\" type=\"primary\">Submit</a-button> -->\n            </div>\n        </a-drawer>\n    </div>\n</template>\n\n<script>\n    export default {\n        name: \"LoanManage\",\n        data() {\n            return {\n                data: [],\n                detailValue: {},\n                loanPayment: [],\n                visible: false,\n                clickrow: 0,\n                searchText: \"\",\n                columns: [{\n                        title: \"交易流水号\",\n                        dataIndex: \"transId\",\n                        key: \"transId\",\n                        width: 100,\n                        fixed: 'left'\n                    },\n                    {\n                        title: \"Name\",\n                        dataIndex: \"name\",\n                        key: \"name\",\n                        scopedSlots: {\n                            filterDropdown: \"filterDropdown\",\n                            filterIcon: \"filterIcon\",\n                            customRender: \"customRender\"\n                        },\n                        onFilter: (value, record) =>\n                            record.name.toLowerCase().includes(value.toLowerCase()),\n                        onFilterDropdownVisibleChange: visible => {\n                            if (visible) {\n                                setTimeout(() => {\n                                    this.$refs.searchInput.focus();\n                                });\n                            }\n                        }\n                    },\n                    {\n                        title: \"贷款日期\",\n                        dataIndex: \"loanDate\",\n                        key: \"loanDate\"\n                    },\n                    {\n                        title: \"贷款金额\",\n                        dataIndex: \"loanAmount\",\n                        key: \"loanAmount\"\n                    },\n                    {\n                        title: \"贷款总金额\",\n                        dataIndex: \"loanAmountSum\",\n                        key: \"loanAmountSum\"\n                    },\n                    {\n                        title: \"已收到金额\",\n                        dataIndex: \"recoveredAmount\",\n                        key: \"recoveredAmount\"\n                    },\n                    {\n                        title: \"贷款状态\",\n                        dataIndex: \"loanStatus\",\n                        key: \"loanStatus\",\n                        filters: [{\n                                text: \"未到期\",\n                                value: \"未到期\"\n                            },\n                            {\n                                text: \"已还清\",\n                                value: \"已还清\"\n                            },\n                            {\n                                text: \"逾期\",\n                                value: \"逾期\"\n                            }\n                        ],\n                        onFilter: (value, record) => record.loanStatus == value\n                    },\n                    {\n                        title: \"操作\",\n                        dataIndex: \"operation\",\n                        scopedSlots: {\n                            customRender: \"operation\"\n                        },\n                        width: 70,\n                        fixed: 'right'\n                    }\n                ],\n                paymentColumns: [{\n                    title: \"还贷交易流水号\",\n                    dataIndex: \"paymentId\",\n                    key: \"paymentId\"\n                }, {\n                    title: \"还贷批次\",\n                    dataIndex: \"insNum\",\n                    key: \"insNum\"\n                }, {\n                    title: \"本次还贷金额\",\n                    dataIndex: \"paymentAmount\",\n                    key: \"paymentAmount\"\n                }, {\n                    title: \"还贷时间\",\n                    dataIndex: \"paymentDate\",\n                    key: \"paymentDate\"\n                }]\n            };\n        },\n        methods: {\n            handleSearch(selectedKeys, confirm) {\n                confirm();\n                this.searchText = selectedKeys[0];\n            },\n\n            handleReset(clearFilters) {\n                clearFilters();\n                this.searchText = \"\";\n            },\n            showDrawer(value) {\n                console.log(value);\n                this.visible = true;\n                this.$axios({\n                        method: \"get\",\n                        // url: \"/loan/\"+ value\n                        url: '/loan'\n                    })\n                    .then(res => {\n                        let result = res.data;\n                        console.log(result.data);\n                        let status = result.status;\n                        if (status == 200) {\n                            this.detailValue = result.data.loan;\n                        } else {\n                            this.$notification.open({\n                                message: \"错误\",\n                                description: result.msg\n                            });\n                        }\n                    })\n                    .catch(err => {\n                        console.log(\"通信失败，请稍后再试\");\n                        this.$notification.open({\n                            message: \"错误\",\n                            description: \"服务器开小差了,请稍后再试\"\n                        });\n                    });\n\n                this.$axios({\n                        method: \"get\",\n                        // url: \"/loan/payment\"+ value\n                        url: '/loan/payment'\n                    })\n                    .then(res => {\n                        let result = res.data;\n                        let status = result.status;\n                        if (status == 200) {\n                            let array=result.data.bankPayment;\n                            for(let i=0;i<array.length;i++){\n                                array[i].paymentDate = this.formatDate(array[i].paymentDate);\n                            }\n                            this.loanPayment = array;\n                        } else {\n                            this.$notification.open({\n                                message: \"错误\",\n                                description: result.msg\n                            });\n                        }\n                    })\n                    .catch(err => {\n                        console.log(err);\n                        console.log(\"通信失败，请稍后再试\");\n                        this.$notification.open({\n                            message: \"错误\",\n                            description: \"服务器开小差了,请稍后再试\"\n                        });\n                    });\n            },\n            onClose() {\n                this.visible = false;\n            },\n            formatDate(value) {\n                let date = new Date(parseInt(value) / 1000);\n                return `${date.getFullYear()}-${date.getMonth() + 1}-${date.getDate()}`;\n            },\n            formatLoanStatus(value) {\n                let status = \"\";\n                switch (value) {\n                    case 1:\n                        status = \"未到期\";\n                        break;\n                    case 2:\n                        status = \"已还清\";\n                        break;\n                    case 3:\n                        status == \"逾期\";\n                        break;\n                }\n                return status;\n            }\n        },\n        mounted() {\n            // console.log(\"开始通信\");\n            this.$axios({\n                    method: \"get\",\n                    url: \"/loan/record\"\n                })\n                .then(res => {\n                    let result = res.data;\n                    console.log(result.data);\n                    let status = result.status;\n                    if (status == 200) {\n                        for (let i = 0; i < result.data.length; i++) {\n                            result.data[i].loanDate = this.formatDate(result.data[i].loanDate);\n                            result.data[i].loanStatus = this.formatLoanStatus(parseInt(result.data[i].loanStatus));\n\n                            // result.data[i].operation = '<a-button type=\"primary\">查看详情</a-button>'\n                        }\n                        this.data = result.data;\n                    } else {\n                        this.$notification.open({\n                            message: \"错误\",\n                            description: result.msg\n                        });\n                    }\n                })\n                .catch(err => {\n                    console.log(\"通信失败，请稍后再试\");\n                    this.$notification.open({\n                        message: \"错误\",\n                        description: \"服务器开小差了,请稍后再试\"\n                    });\n                });\n        }\n    };\n</script>\n\n<style scoped lang=\"scss\">\n    .custom-filter-dropdown {\n        padding: 8px;\n        border-radius: 6px;\n        background: #fff;\n        box-shadow: 0 1px 6px rgba(0, 0, 0, 0.2);\n    }\n\n    .custom-filter-dropdown input {\n        width: 130px;\n        margin-right: 8px;\n    }\n\n    .custom-filter-dropdown button {\n        margin-right: 8px;\n    }\n\n    .highlight {\n        color: #f50;\n    }\n</style>"]}]}